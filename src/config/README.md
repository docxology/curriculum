# Configuration Management

Configuration loading and validation module.

## Files

- `loader.py` - `ConfigLoader` class for loading YAML configurations

## Overview

This module provides centralized configuration management for the educational course generator. All YAML configuration files are loaded through the `ConfigLoader` class, which provides validation, caching, and convenient accessor methods.

## Usage

```python
from src.config.loader import ConfigLoader

# Initialize
loader = ConfigLoader("config")

# Validate all configurations
loader.validate_all_configs()

# Access course data
course_info = loader.get_course_info()

# Load modules from JSON outline (dynamic generation)
modules = loader.get_modules_from_outline()  # Uses latest outline
module_1 = loader.get_module_by_id_from_outline(1)

# Convenience methods (same as above)
modules = loader.get_modules()  # Same as get_modules_from_outline()
module_1 = loader.get_module_by_id(1)  # Same as get_module_by_id_from_outline()

# Access LLM settings
llm_params = loader.get_llm_parameters()
llm_config = loader.get_llm_config()  # Full config including outline_generation
prompt = loader.get_prompt_template("lecture")

# Access output settings
output_paths = loader.get_output_paths()
```

## ConfigLoader Class

### Attributes
- `config_dir` - Path to configuration directory
- `_course_config` - Cached course configuration
- `_llm_config` - Cached LLM configuration
- `_output_config` - Cached output configuration

### Methods

**Loading**:
- `load_course_config()` - Load course configuration
- `load_llm_config()` - Load LLM configuration
- `load_output_config()` - Load output configuration

**Accessors**:
- `get_course_info()` - Get course metadata
- `get_modules_from_outline([path])` - **NEW**: Load modules from JSON outline
- `get_module_by_id_from_outline(id, [path])` - **NEW**: Load specific module from JSON outline
- `get_modules([from_outline], [path])` - Get all modules (loads from outline by default)
- `get_module_by_id(id, [from_outline], [path])` - Get specific module (loads from outline by default)
- `get_llm_config()` - Get full LLM configuration (including outline_generation settings)
- `get_llm_parameters()` - Get LLM settings (just the llm section)
- `get_prompt_template(name)` - Get prompt template
- `get_output_paths()` - Get output paths

**Helper Methods**:
- `_find_latest_outline_json([path])` - Find most recent JSON outline file

**Validation**:
- `validate_course_config()` - Validate course configuration
- `validate_all_configs()` - Validate all configurations

## Configuration Files

Expected YAML files in `config/` directory:
- `course_config.yaml` - Course metadata and generation parameters (modules are now generated dynamically)
- `llm_config.yaml` - LLM settings and prompts
- `output_config.yaml` - Output directory structure

**JSON Outlines** (generated dynamically):
- `output/outlines/course_outline_TIMESTAMP.json` - Generated course structure with modules and sessions
- Modules are no longer in static YAML - they're generated by the LLM and saved as JSON

See [../../config/README.md](../../config/README.md) for configuration file details.

## Error Handling

Raises `ConfigurationError` for:
- Missing configuration directory
- Missing configuration files
- Invalid YAML syntax
- Missing required fields
- Invalid configuration values

Example:
```python
from src.config.loader import ConfigurationError

try:
    loader = ConfigLoader("config")
    loader.validate_all_configs()
except ConfigurationError as e:
    print(f"Configuration error: {e}")
```

## Integration

Used by all major components:
- `OllamaClient` - Gets LLM parameters
- `ContentGenerator` - Gets course structure
- Content generators - Get prompt templates
- Scripts - Get all configuration data

## Testing

Comprehensive tests in `tests/test_config_loader.py`:
- Configuration loading
- Validation
- Error handling
- Module retrieval
- Template access

Run tests:
```bash
uv run pytest tests/test_config_loader.py -v
```

## See Also

- **For AI Agents**: [AGENTS.md](AGENTS.md) - Complete API reference
- **Configuration Files**: [../../config/README.md](../../config/README.md)
- **Configuration Guide**: [../../docs/CONFIGURATION.md](../../docs/CONFIGURATION.md)

